//	2dgate library
//	code by j113203 { wtapss: +852 91738490 , j113203@gmail.com }
var $2dgate={JSONP:{get:function(t,e,n){$.ajaxSetup({cache:!0});var a=Math.floor(1e10*Math.random());$2dgate.JSONP.finished[a]=$.Deferred(),$.getScript($2dgate.Setup.Proxy+encodeURIComponent(t)+"&callback=$2dgate.JSONP.finished["+a+"].resolve").done(function(){$.when($2dgate.JSONP.finished[a]).done(function(t){return $2dgate.JSONP.finished[a]=void 0,e(t.contents||t.data||t[Object.keys(t)[0]]||t)})}).fail(function(){$.getScript("//query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select content from data.headers where url="'+t+'"')+"&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&format=json&callback=$2dgate.JSONP.finished["+a+"].resolve").done(function(){$.when($2dgate.JSONP.finished[a]).done(function(t){return $2dgate.JSONP.finished[a]=void 0,e(t.query.results.resources.content||t)})}).fail(function(){return n()})})},finished:{}},Setup:{Proxy:"http://user.frdm.info/ckhung/i/ba-simple-proxy.php?url="},FanHuaJi:function(t,e,n){$2dgate.JSONP.get("https://sctctw.2d-gate.org/api.php?text="+t+"&to="+e,function(t){n("string"==typeof t?$.parseJSON(t):t)})},Anime:{tid:function(t,e){$2dgate.JSONP.get("http://2d-gate.org/thread-"+t+"-1-1.html",function(t){var n=[];t=$($.parseHTML(t,null,!1)),a=t;var i={};return $.each(t.find("td.t_f ul a"),function(e,n){n=$(n);var a=n.attr("href");a=a.substring(a.lastIndexOf("#"));var d=[];a=t.find("td.t_f div"+a+" div.gd_thumb").attr("onclick")||"",a&&(a=a.match(/javascript:gdclick_2dg\(.*,'(.*?)',.*/)[1]),d.push({subject:n.text(),id:a}),i[e]=d}),n.push({subject:t.find("a#thread_subject").children().remove().end().text(),extra:t.find("h1:eq(1)").text(),intro:t.find("span.intro").text(),staff:t.find("div.highslide-maincontent").text(),video:i}),e(n)})},weeks:function(t,e){$2dgate.JSONP.get("http://2d-gate.org/forum-78-1.html",function(n){var a=[];return $.each($($.parseHTML(n,null,!1)).find("table#olAL tbody").children(),function(e,n){return $(n).find("th:eq(0)").text()!=t?!0:($.each($(n).find("td:eq(0)").children(),function(t,e){var n=$(e);a.push({subject:n.text(),tid:n.attr("href").match(/thread-(.*?)-.*-.*\.html/)[1]})}),!1)}),e(a)})},list:function(t){$2dgate.JSONP.get("http://anime.2d-gate.org/__cache.html",function(e){var n=[];return $.each($($.parseHTML(e,null,!1)).filter("table#animeList").children("tbody").children(),function(t,e){var a=$(e);n.push({subject:a.find("td:eq(6)").html(),year:a.find("td:eq(1)").text(),season:a.find("td:eq(2)").text(),views:a.find("td:eq(3)").text(),dateline:a.find("td:eq(4)").text(),lastpost:a.find("td:eq(5)").text(),tid:a.find("td:eq(0) a").attr("href").match(/thread-(.*?)-.*-.*\.html/)[1]})}),t(n)})},list_:function(t){$2dgate.JSONP.get("http://anime.2d-gate.org/?jsonOnly=1",function(e){return t(e.json.threads||$.parseJSON(e.split("\n").pop()).threads)})}},thumbnail:function(t,e,n){return e&&(e="&w="+e),n&&(n="&h="+n),"http://thumbnail.2d-gate.org/?src="+t+(e||"")+(n||"")}};